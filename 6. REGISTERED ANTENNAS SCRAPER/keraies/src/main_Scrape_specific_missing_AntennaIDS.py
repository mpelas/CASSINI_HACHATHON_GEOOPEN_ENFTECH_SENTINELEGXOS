#!/usr/bin/env python3
import asyncio
import re
import time
from typing import Dict, List, Optional, Any, Set
import sys
import io

sys.stdout = io.TextIOWrapper(sys.stdout.buffer, encoding='utf-8')

try:
    from apify import Actor
except ImportError:
    print("Warning: apify package not found. Install with: pip install apify")

    # Mock Actor for local testing
    class MockActor:
        class log:
            @staticmethod
            def info(msg):
                print(f"INFO: {msg}")

            @staticmethod
            def warning(msg):
                print(f"WARNING: {msg}")

            @staticmethod
            def error(msg):
                print(f"ERROR: {msg}")

        @staticmethod
        async def get_input():
            # Return default input for local testing
            return {"antenna_ids": []}

        @staticmethod
        async def push_data(data):
            print(f"Would push {len(data)} records to dataset")
            # For local testing, you could save to JSON file
            import json
            with open('scraped_data.json', 'a', encoding='utf-8') as f:
                for item in data:
                    f.write(json.dumps(item, ensure_ascii=False) + '\n')

        def __aenter__(self):
            return self

        def __aexit__(self, exc_type, exc_val, exc_tb):
            pass

    Actor = MockActor()

from bs4 import BeautifulSoup
import aiohttp
from aiohttp import ClientSession, ClientTimeout

class GreekAntennaScraper:
    def __init__(self):
        self.base_url = "https://keraies.eett.gr"
        self.search_url = f"{self.base_url}/getData.php"
        self.details_url = f"{self.base_url}/getDetails.php"
        self.headers = {
            "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:131.0) Gecko/20100101 Firefox/131.0",
            "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8",
            "Accept-Language": "el-gr,en;q=0.5",
            "Accept-Encoding": "gzip, deflate, br, zstd",
            "Content-Type": "application/x-www-form-urlencoded",
            "Origin": "https://keraies.eett.gr",
            "DNT": "1",
            "Sec-GPC": "1",
            "Connection": "keep-alive",
            "Referer": "https://keraies.eett.gr/anazhthsh.php",
            "Cookie": "cookielawinfo-checkbox-functional=yes; cookielawinfo-checkbox-necessary=yes; viewed_cookie_policy=yes",
            "Upgrade-Insecure-Requests": "1",
            "Sec-Fetch-Dest": "document",
            "Sec-Fetch-Mode": "navigate",
            "Sec-Fetch-Site": "same-origin",
            "Sec-Fetch-User": "?1",
            "Priority": "u=0, i"
        }

    async def make_request_with_retry(self, session: ClientSession, url: str, data: Dict, max_retries: int = 6) -> Optional[aiohttp.ClientResponse]:
        """Make HTTP request with retry mechanism."""
        for attempt in range(max_retries):
            try:
                timeout = ClientTimeout(total=600)
                async with session.post(url, headers=self.headers, data=data, timeout=timeout) as response:
                    if response.status == 200:
                        content = await response.read()
                        response._content = content
                        return response
                    else:
                        Actor.log.warning(f"HTTP {response.status} on attempt {attempt + 1}")
            except Exception as e:
                Actor.log.warning(f"Request failed on attempt {attempt + 1}: {e}")
                if attempt < max_retries - 1:
                    await asyncio.sleep(2 ** attempt)  # Exponential backoff
        return None

    async def get_antenna_details(self, session: ClientSession, antenna_id: str) -> Dict[str, Any]:
        """Get detailed information for a specific antenna."""
        Actor.log.info(f"Getting details for antenna ID: {antenna_id}")

        data = {"appId": antenna_id}

        response = await self.make_request_with_retry(session, self.details_url, data)
        if not response:
            Actor.log.error(f"Failed to get details for antenna {antenna_id}")
            return {"antenna_id": antenna_id, "error": "Failed to fetch details"}
        soup = BeautifulSoup(response._content, 'html.parser')

        antenna_data = {
            'antenna_id': antenna_id,
            'address': "-",
            'position_code': 9999999999,
            'municipality': "-",
            'code_name': "-",
            'region': "-",
            'latitude': 0.0,
            'company': "-",
            'longitude': 0.0,
            'permit_status': "-",
            'measurements_eaee': "-",
            'documents': []
        }

        # Find antenna data divs
        antenna_divs = soup.find_all('div', class_='alert alert-info my-alert3')

        if antenna_divs:
            # Extract basic information from first div
            if antenna_divs[0].find_all('div', class_='row'):
                rows = antenna_divs[0].find_all('div', class_='row')
                for current_row in range(1, len(rows)):
                    row = rows[current_row]
                    for col in row.find_all('div'):
                        heading_elem = col.find('p', class_='list-group-item-heading')
                        value_elem = col.find('p', class_='list-group-item-heading2')
                        if heading_elem and value_elem:
                            heading = heading_elem.text.strip()
                            value = value_elem.text.strip()

                            # Map Greek field names to English keys
                            field_mapping = {
                                'Διεύθυνση/ Περιγραφή θέσης': 'address',
                                'Κωδικός αριθμός θέσης': 'position_code',
                                'Δήμος': 'municipality',
                                'Κωδική ονομασία': 'code_name',
                                'Περιφέρεια': 'region',
                                'Γεωγρ. πλάτος (WGS84)': 'latitude',
                                'Εταιρία': 'company',
                                'Γεωγρ. μήκος (WGS84)': 'longitude'
                            }

                            if heading in field_mapping:
                                key = field_mapping[heading]
                                if key in ['latitude', 'longitude']:
                                    try:
                                        antenna_data[key] = float(value)
                                    except ValueError:
                                        antenna_data[key] = 0.0
                                elif key == 'position_code':
                                    try:
                                        antenna_data[key] = int(value)
                                    except ValueError:
                                        antenna_data[key] = 9999999999
                                else:
                                    antenna_data[key] = value
            # Extract permit status from second div
            if len(antenna_divs) > 1:
                mytext_elem = antenna_divs[1].find('div', class_='mytext')
                if mytext_elem:
                    antenna_data['permit_status'] = mytext_elem.text.strip()

                measurements_elem = antenna_divs[1].find('div', class_='list-group-item-heading2')
                if measurements_elem:
                    antenna_data['measurements_eaee'] = str(measurements_elem)

            # Extract documents from third div
            if len(antenna_divs) > 2:
                tables = antenna_divs[2].find_all('table', class_='my-table')
                documents_list = []
                for table in tables:
                    document_rows = table.find_all('tr')[1:]  # Skip header
                    for doc_row in document_rows:
                        doc_data = self.extract_document_data(doc_row)
                        if doc_data:
                            documents_list.append(doc_data)
                antenna_data['documents'] = documents_list
        return antenna_data

    def extract_document_data(self, row):
        """Extract data from document table row."""
        cells = row.find_all('td')
        if len(cells) >= 5:
            return {
                'document_number': cells[1].text.strip(),
                'protocol_number': cells[2].text.strip(),
                'type': cells[3].text.strip(),
                'file_url': cells[4].find('a')['href'] if cells[4].find('a') else None
            }
        return {}

async def main_Scrape_specific_missing_AntennaIDS():
    async with Actor:
        Actor.log.info("Starting Greek Antenna Scraper - Specific Antenna IDs")

        scraper = GreekAntennaScraper()

        # Define the list of antenna IDs to scrape
        antenna_ids = [
            84283,42770,102364,56181,76362,103909,56158,24203,68042,76044,80789,56184,81439,26111,106620,107071,
            111509,106870,125308,125310,127709,24931,100453,79759,152896,152522,152915,154683,163311,163303,
            170459,171213,171535,171960,135074,111747,172424,172828,108399,109211,104208,63780,124842,124401,
            146564,108914,124430,109138,145150,150971,142791,146657,100200,101963,74952,91396,47916,48734,81315,
            79351,64912,85001,104692,46431,41373,90354,62148,92421,100331,86989,78412,39176,82693,108762,109396,
            109529,112493,112787,112227,112305,24741,112065,112958,112688,113757,110133,112445,103429,115428,
            116299,119563,71211,123108,141403,144589,146190,71778,155854,157043,159041,160550,161120,164865,
            169382,136247,110671,112827,110526,141373,165839,144698,126416,112322,110495,133029,157585,134664,
            161387,159362,158870,169501,169802,166938,176443,165522,160253,173352,173433,103964,88450,130045,92204,
            134861,104606,46434,179756,104644,172976,107065,118898,145231,143253,144529,150625,145315,81762,71685,
            62232,79758,84066,81109,56537,158530,160109,158531,163280,163281,165117,165119,172155,158529,128049,
            157901,165113,125855,107393,160050,113784,143702,100080,81070,81435,80564,80057,84194,86214,81184,86227,
            68187,41024,76052,20597,27464,109569,108960,108869,111014,111919,111932,111506,140521,142544,156553,
            159559,160956,161362,163130,165832,164740,167568,166134,144852,155138,129604,129603,115368,126395,
            131405,164227,112543,133899,146374,168893,110153,170812,104609,136514,164803,143600,111778,167908,
            142177,70571,176363,176392,176359,176331,101243,70626,106529,79750,29743,108787,108615,109175,109705,
            109049,111861,111293,111303,157692,159554,158272,160029,160892,161779,161452,161445,161444,161657,
            160827,162124,113123,145854,30805,100964,103730,23131,40479,46478,100522,101153,108804,109135,113190,
            169478,66988,116790,131273,83650,28365,144558,144563,155628,113552,133989,152419,155995,155992,156103,
            154694,163480,157918,161584,160869,164991,164998,165029,125834,124459,125832,116671,131726,129346,91270,
            128599,131796,116694,132264,132772,113049,170834,101370,169961,125849,160838,172067,169336,113571,172243,
            156869,157262,169163,26223,169380,173288,173613,174179,176149,177171,171729,155749,178319,178971,42538,
            43981,40796,59711,30252,30248,30246,100354,100526,23721,45558,44026,84098,63268,68958,76564,23520,23723,
            28922,30322,22738,26990,40270,47533,82699,103970,29858,84999,77798,103656,104425,70222,103918,83822,
            86096,60472,128910,128915,129021,57961,84697,103726,141581,146042,173915,155229,101148,167667,131926,
            129352,131202,134925,135549,134540,140786,143727,142717,135550,152917,158457,168554,172320,168089,
            103958,175456,113611,156197,68086,68164,84521,65890,81567,70129,106988,30787,27768,72455,43064,85545,
            83068,79317,107960,75461,71784,85083,59655,126565,127372,127389,130355,128358,71264,108283,79737,109551,
            152508,175870,176100,126641,156533,68998,176282,172856,177004,101254,177053,174758,174711,20509,80054,
            83839,20623,91837,103240,84507,41258,102487,76633,45982,109535,163019,133187,110090,155065,158392,
            115509,118001,145508,170402,86024,164634,109294,109069,104887,117376,163489,164870,165545,165079,
            174530,171528,101847,142689,77533,157818,134208,136956,169020,176099,142629,174124,179793,177141,
            87284,150569,84289,91832,69490,46744,92283,80419,41489,26595,64305,70922,76188,76104,47478,108640,
            109128,109363,109394,109390,108949,109642,109212,109721,109447,109013,109251,110895,110325,110868,
            109767,110677,109806,112139,112766,112490,112494,112812,112857,155200,154981,157397,157067,158061,
            158223,160137,159627,160902,162266,161338,161705,109722,110465,109665,158008,109095,109273,109458,
            109274,112394,114282,113841,112197,108747,145001,145006,142603,145010,109293,142602,175683,124321,
            124322,169171,109286,112400,112691,161407,112700,114348,114432,115465,115733,124319,124325,124326,
            124327,103270,177849,178356,88543,117714,131091,173125,82468,179579,73777,126812,173126,130595,100367,
            136092,136337,144235,156124,156965,159278,158341,161857,164498,166928,132432,132809,102134,21302,
            136407,80928,102003,129789,152629,152388,152658,158437,76623,175750,132456,131244,133977,133966,
            151048,162141,141744,73902,55905,25889,144360,142592,143479,25989,152507,152615,152416,157235,157234,
            158769,158259,161612,22086,106108,114587,101242,78585,142132,157470,171604,175029,105616,128894,154886,
            130566,128835,23327,136748,136911,141608,143738,144625,143485,143484,143486,143802,81693,100523,111032,
            111136,111492,110448,110500,110235,110094,113691,113930,116731,179220,179712,55448,136237,133911,150349,
            56979,90144,85312,110928,110750,112426,88628,146204,146654,150612,152950,150339,160513,160369,145360,
            141087,160564,101221,102481,87409,128222,101677,155048,156603,174068,123306,152999,163905,172702,
            172704,124707,171832,140863,163638,164648,135009,144521,144887,144818,146836,150548,163003,135787,
            132943,141132,128489,128682,155213,132410,155212,168145,165109,165030,164880,108859,108500,108713,
            107522,109339,108992,111426,111468,111275,110042,173952,88715,126796,113756,119096,131889,101828,
            175859,174373,85468,133957,141283,155259,167717,146797,144103,74210,74445,101088,25922,70157,74711,
            101446,76477,103542,21299,114737,173179,100766,161541,173532,89388,169936,107537,70561,180157,141622,
            140859,101995,68671,22741,55141,89428,101283,62251,106246,105767,106649,105465,101514,154801,142433,
            109766,158656,142436,111437,156664,161365,175748,133006,172205,110848,158926,159341,159318,159300,
            159309,165263,165264,165254,165044,165228,167615,165248,152679,154602,157792,157814,161456,160885,
            163242,170188,167722,104594,129976,124893,108911,109572,109176,109600,108975,109410,109009,109620,
            111019,111624,112022,111929,112963,112092,112387,112676,112709,114430,113689,115275,115345,114250,
            117108,115813,136199,136136,136412,174199,134225,140874,145649,145665,144029,143012,143848,141859,
            158359,159194,158704,159989,159077,161371,161786,161852,161135,161192,160630,162262,119893,119892,
            158147,164528,115259,141224,115899,157489,168332,166980,153060,164977,100486,178061,175392,174558,
            174495,179113,174364,177499,78833,179130,179476,179608,76614,62185,80059,102254,100873,86026,88936,
            104686,85098,104427,60892,75352,110063,110684,110699,105848,84378,113427,112767,112803,112243,112250,
            112280,112946,155222,154586,154958,155778,157118,157411,157686,157911,157394,158451,159923,159398,
            101400,170046,170810,79923,91803,131282,152367,152612,126905,114058,150162,133217,67749,161750,103471,
            179335,134763,143434,150798,146851,101154,67929,20473,89129,161528,160821,167964,166873,172100,154819,
            171541,105164,135859,128098,114318,152337,143968,55883,60583,67997,102489,72480,21340,87088,109509,
            70267,127157,55894,162112,160354,168028,166118,166659,169228,174815,105408,90362,167349,25060,55457,
            64585,178412,167024,169464,172228,79559,76206,134767,142914,102515,24050,70619,47394,111291,110908,
            110221,110654,110659,110364,103557,107174,106049,107183,113992,78143,102731,55620,100415,75447,106384,
            108407,111318,55608,106668,116580,119234,142999,142903,144788,145423,135026,146471,146468,152375,
            160335,82974,101023,24826,116487,116490,116482,101111,124956,127478,127544,127265,131663,129999,
            131192,130006,169663,168556,174846,172330,167599,168195,111052,167861,109768,167784,168689,167460,
            131132,175103,172392,108765,173156,170481,172562,162478,166348,164583,112845,162110,177811,177963,
            177965,76468,179581,175369,142392,173004,164499,175179,180451,144495,163230,163299,165037,164985,
            171254,113767,172200,177572,116810,178659,179208,132896,86337,119281,155679,174666,168262,92293,
            90784,176046,110937,100862,156132,135701,119825,108389,125586,128400,129520,135029,154972,155245,
            155264,155136,109717,141919,143779,169803,133643,109187,169234,158882,83848,179333,22569,
            102554,123628,157543,152534,152517,152580,155005,159070,163390,163391,165009,171503,142007,157247,
            83983,111083,111984,111983,111240,111803,111537,110725,109948,109953,110580,109796,110382,111944,
            76604,154664,157588,156722,158440,159117,159935,158260,158302,158937,159887,144534,143200,161314,
            118794,172278,158444,128326,108721,130950,142212,118031,127711,154723,165144,165112,166500,130884,
            143549,167185,154689,172624,172656,177444,169821,152516,152560,154681,154677,154695,157699,158548,
            159441,158446,158539,163286,163294,143855,158517,158524,103523,174630,152925,106703,104202,150250,
            134996,134904,135066,127057,128145,129706,84848,129671,133718,137098,141800,141826,145136,141799,
            137099,170078,113857,165105,165106,104096,174583,162164,171542,170413,171569,170075,174275,110977,
            105035,110341,100284,75481,112166,112328,112351,112932,114538,115702,117925,78080,26923,81194,65035,
            102351,103577,89406,75473,48758,79741,86018,71459,112521,112528,112255,112853,112265,112609,114217,
            114700,109843,112702,113542,116380,155217,154611,154575,157078,157580,156616,160187,159324,159748,
            159749,159858,158422,175478,123283,112260,115687,140637,155368,145458,141400,155955,157779,161043,
            123363,145366,20725,56840,84190,29556,56846,56841,59857,81764,54777,101119,21705,144326,152424,
            152557,152652,152513,152864,152521,174472,161558,161476,160873,161477,106713,71954,171009,165592,
            124748,176123,162430,167450,175256,176796,177170,152775,166256,132283,176140,172626,110573,145135,
            163032,85070,90283,76629,29976,67922,165523,108906,109006,109299,116129,133653,163007,126387,156395,
            112268,136173,161471,114701,113500,107180,116548,115757,119230,123882,123880,79307,135013,141167,
            145235,103650,177786,89403,146722,150628,102048,101244,78493,73342,103343,55361,91029,103891,
            103530,108708,86508,112624,84496,115362,124723,128765,130989,111143,29795,168727,165038,174093,
            176127,176872,175536,118643,176121,176893,150741,81322,24674,130930,108362,146910,174415,152850,
            160791,161670,164571,165222,164967,164379,164440,58115,58054,105566,108993,108067,109985,110400,
            118488,106809,133192,143975,142169,30115,29767,154736,154737,154460,154448,154456,154449,154450,
            161350,161356,163728,59851,71568,24208,82846,26597,28638,71582,101895,79015,80209,106751,111030,
            165235,170996,171829,143261,143481,143482,171399,171397,71293,175102,178233,179995,115037,114085,
            114280,114174,115243,84191,107816,123974,125623,127417,126308,126305,165082,165097,164885,164744,
            165823,165075,165078,167557,174852,165330,111866,175673,108371,108903,109178,111465,104168,88690,
            66469,157096,167354,171023,123109,150335,125164,124183,124001,127167,126894,86610,44077,136182,
            135308,100517,152405,156394,109584,108990,89452,109072,111111,111790,110824,109901,110687,101195,
            113370,112465,156806,157496,157579,159310,158298,161104,161106,163015,163684,162663,166119,167623,
            89379,71491,62788,77871,84883,100975,75669,45218,47560,21433,43204,177368,161243,162596,164562,
            167307,168240,168245,171216,174330,116094,150870,161564,164298,172797,135748,144149,146525,150555,
            154835,160092,143833,102280,76750,76553,86291,144542,129433,126374,174552,84348,175812,167799,
            177021,136486,150728,150843,72914,113886,123982,152964,158015,158913,174205,101740,163001,176456,
            86146,146041,150169,114522,115499,116173,119653,25496,123848,126050,125829,127670,130674,114534,
            132099,84282,135441,140508,72143,71387,71593,105259,111043,111041,111146,110412,110314,80784,103060,
            103011,100379,78746,87499,56141,47953,74129,56145,74772,74619,109311,107956,126853,130622,131034,
            103213,165442,168902,118563,168038,175992,179958,163653,165238,165448,167636,172086,130117,124161,
            165249,170918,172683,172982,136433,167803,173548,180399,179259,134710,145457,61174,101545,21013,
            112323,112079,112977,110916,110223,88589,119861,119863,110959,124389,124654,125234,126297,62250,
            156375,160185,161634,169974,171191,171506,124160,166940,113955,118099,110534,173329,171327,115624,
            162776,141798,143106,114584,126037,140716,112309,134088,157083,118925,143912,81076,73271,106859,
            70952,110961,114133,106298,119003,104516,80752,102167,124563,126446,129364,134281,133084,133524,
            135612,74027,78122,152403,152638,157769,157875,158261,161632,161707,160831,162626,163201,165084,
            164391,165008,167356,166398,167531,167530,111004,172743,173287,168266,177037,174820,178316,176975,
            100579,104286,152690,71581,24676,55503,23336,89187,77647,71489,70982,57004,114309,117746,119991,
            127135,131761,174187,133206,136657,112764,151092,155844,158925,158928,159755,159825,158895,159744,
            163535,165271,137161,136367,143976,145507,68063,141865,141918,158490,165892,167696,166379,170753,
            161669,174652,164794,168588,174842,172049,174018,176043,131713,132525,129879,86136,158057,159577,
            160011,160348,160292,161886,168118,27132,133791,118116,164912,114294,88732,73333,62253,30468,78054,
            65949,71953,24922,38292,82708,88444,29750,108033,156988,111281,111592,111301,112023,111951,111210,
            111526,110972,110718,110462,127042,127189,128004,126157,131127,131715,29451,129303,88962,130369,
            129016,132611,174522,156866,158201,157742,157643,157642,157740,158997,158349,158491,158492,
            158281,115940,70883,152959,164922,175614,128563,115924,123999,108590,133028,131972,117587,
            124873,133491,112554,146463,110690,166598,144987,129438,132607,133996,119236,144684,104898,
            177203,177206,177298,173955,173981,172329,175669,77360,177571,164270,177820,127416,119007,
            136289,151094,154765,154516,154519,154707,157313,159340,160157,161981,56454,56477,26857,88948,
            101280,100712,56296,55037,71307,55485,106719,56289,107679,109026,112156,112908,114927,113680,
            113773,113685,101800,55094,114743,113690,113716,113715,56284,115990,56295,125153,127878,126975,
            127552,127448,127546,130952,131375,130610,143725,141989,143224,113699,152519,152497,152536,
            152533,153014,153015,154679,154692,157944,156289,157152,156288,156499,158839,157060,159723,
            158773,161702,163469,163333,163216,162681,163460,163463,163464,165017,165058,156605,165033,
            164352,165020,164763,164995,165099,171698,100389,125878,143424,164082,135511,143250,168323,
            102443,172767,176650,135198,176496,150204,100664,46471,25565,56612,87289,63314,23593,74413,56614,
            73643,108962,107464,111360,112279,112134,113999,117683,119151,119662,126758,126666,126873,76034,126874,
            158088,158160,157478,160879,161493,163585,163842,164031,163582,165186,169170,168866,131451,143247,
            165997,126755,125564,133921,169900,166052,173934,177761,178240,173238,83039,145722,113091,144462,61958,
            43183,72414,91085,86161,84401,74058,78702,102893,23586,110572,109777,20686,103103,117503,74859,73328,
            119803,71987,102919,88591,124929,126098,128483,131454,140986,87692,157405,160848,164491,164558,166968,
            117999,142788,164582,110988,175957,157435,176414,68723,130110,108218,56580,84849,80913,56570,100621,115661,115737,100854,132706,132817,133446,135224,150646,133947,27207,63623,28158,64901,71679,60603,20584,30205,28609,66822,89098,79190,101302,108806,108699,109405,173867,111104,112004,111972,110808,83886,112438,112427,112198,76279,112321,112922,86083,109858,75522,90990,84332,177367,71022,127301,73038,70903,91861,87123,60897,65124,111692,144471,155121,144772,63982,126584,111959,112779,117208,166279,124794,140966,108564,109856,112761,109110,109677,110717,108855,134089,112410,170791,144275,109822,105467,150766,103414,55774,65971,102900,102372,110226,105506,103539,131561,141830,165213,168046,166230,172426,158275,170104,132850,125565,109916,133360,124002,158176,111847,110890,110853,110044,110362,113303,112488,112501,112314,112315,112318,112930,161569,161030,165884,167650,167303,103388,168539,140942,171735,84108,111150,142045,103249,86139,141085,165381,76512,73030,57582,102949,57495,76969,112900,110195,112988,115338,116743,103692,122977,140717,106372,152527,152614,152501,158520,158521,164474,166815,171199,170602,136968,165042,100628,141595,141445,171025,173212,173547,118229,105867,58465,107137,74698,130195,107354,72149,152385,155055,154514,154526,145617,143776,159311,158690,159290,136003,158756,143837,103840,175199,66912,178329,164876,135270,129263,172763,101647,116273,143715,144657,134707,134846,150579,146430,165188,141998,168541,171576,127264,117371,127270,116908,116841,161050,127585,127273,126321,124693,113896,113908,158313,177669,118065,101458,143947,144762,160188,30284,161684,160788,160626,163554,171548,170822,172110,136923,83807,145402,111132,132215,146658,144675,153020,159819,146007,78010,77630,72529,29618,76635,77000,81400,165209,165223,165216,165217,165225,164630,165224,166949,167655,169701,175014,168646,110996,110504,110911,109902,110873,110261,109788,51821,110151,91856,117224,165973,132414,167226,108942,161062,164717,165934,172475,136586,123301,141961,111879,143243,104294,55825,104608,77198,102035,101770,71335,78729,106439,107200,109497,110960,112879,112069,100877,86081,116117,118232,119167,123382,25765,127102,103308,136126,109532,110901,110968,111813,111457,111197,158076,123795,134921,159791,167402,132860,78601,114227,152981,161310,160747,163501,167764,132128,125660,169748,176747,132629,112871,112588,112918,112341,110445,108373,116051,115797,119412,119962,114692,111119,164943,130155,113233,160365,145683,157685,151090,152725,142166,110710,161867,115608,23719,108663,108742,108956,109465,109641,107091,111567,111890,111640,112030,112032,100288,118892,112706,141444,164221,141443,136635,25631,
            102021,178306,178393,102345,72231,78942,86489,85074,42948,114167,86611,114634,104718,91693,107897,30444,107728,107424,108912,146066,109003,109270,109082,107136,107571,107797,107502,107581,115263,115247,113593,104607,117065,119535,91006,85178,115012,123311,124262,114438,130186,128713,132945,130943,132093,129774,130320,132081,100040,134943,134961,134524,134026,134531,133812,134096,141491,38312,143427,142076,100637,144588,101776,91834,77372,114533,146267,151054,152990,107664,105495,154687,155987,155631,156203,157475,157104,157741,161563,160443,160942,162220,162239,161016,163026,163683,162772,163754,164513,165656,166772,168027,168021,167853,166639,168878,168097,170606,174877,174468,168281,168882,167768,110143,112651,174312,175428,123295,118536,137002,128209,110425,110359,125012,134962,101814,63625,115322,123805,135017,74777,124248,159484,173997,141494,109250,176007,113903,118519,132080,128841,136175,172338,145560,161409,112039,109249,167775,140964,103105,173357,131111,178183,72838,176671,160203,105187,102778,176567,174377,176898,176193,100507,173793,59638,74888,102850,29023,102434,104124,84398,101560,25638,89125,102216,101094,146410,117781,119027,142591,111473,151130,152733,161621,162509,164662,170562,73204,83775,86150,71991,69961,74916,21163,104643,85062,74941,101188,103206,115868,108934,109186,109216,109020,109711,109485,109268,109047,109627,109098,108216,109115,112324,112080,112650,112951,112093,112392,112686,113761,113942,104046,110735,105941,135840,140442,140725,146034,142195,143283,143167,145385,142813,142599,142681,142693,162949,165624,158027,164619,170963,170980,119703,172317,168692,175545,169012,136380,172122,127170,146013,69798,176404,167098,83644,108437,22997,136232,151143,104645,100723,100504,64972,75487,78911,79120,56420,86333,100668,105746,106305,105120,101229,133651,84039,89093,154815,100286,100213,86957,100402,68955,73905,101484,123580,125013,132057,119456,104071,84716,140854,86152,168666,103261,128666,79350,179653,141911,145874,150300,150303,134948,135103,144137,100296,26364,90445,66800,108944,109044,109715,109331,111868,111634,111930,112058,111808,110965,109885,110511,136468,133951,135946,141423,145688,142101,143295,142278,110578,110698,152509,155293,119704,146901,116139,112487,29288,25628,129838,170191,167953,112317,141806,171229,118174,165920,170638,116182,128782,164128,157927,110175,110046,128943,113855,177872,62756,74416,103825,73041,105496,108796,116275,116632,129900,141517,140839,174663,102190,102682,86626,76561,86479,43129,101715,106201,106273,106281,107644,109801,112115,142700,155063,134891,142663,113960,124098,126111,90539,84385,103535,174687,113401,114939,116138,114281,125166,127850,132040,131628,63979,145331,107567,155988,179878,171338,172571,172862,175383,117622,122978,130057,146404,59648,82619,80406,79535,112084,24608,130178,129750,131927,133024,134442,168120,163782,162316,165221,144280,128704,162929,66834,100744,102204,61968,65951,71509,75278,79045,64290,111931,112035,111463,111967,109428,109890,109939,110344,105599,106817,91862,112935,134900,136155,141378,141390,144470,107181,109593,59637,119037,152954,154883,155062,135128,124661,131513,134600,110761,144541,157142,158590,160984,109696,112807,169178,173195,173269,177040,177034,178287,103766,178289,169772,106597,77884,176799,177580,125353,125489,125557,131603,84908,142000,152524,152528,152566,156078,156079,156082,111447,111449,109926,113558,112425,117020,115708,119300,79766,126369,132119,131445,168514,101921,173781,132496,104548,102464,173973,175901,104143,145107,144977,142944,108905,111934,76000,112283,112652,115864,112401,112125,113547,114053,105659,125633,150771,150792,150987,150503,140927,71430,84542,101747,70891,86341,62231,45019,116080,119363,114239,76811,124732,125682,126865,60114,128593,128566,128588,135341,130910,142039,155568,25862,132679,172422,174506,107388,133686,116742,157498,85800,56351,25985,89089,141644,142035,170394,164616,132678,128265,165356,171990,158308,68106,70134,71395,84116,73627,65034,48112,30399,100160,21368,74535,73525,108573,108580,108819,107265,107202,107620,114082,103863,105256,144046,146425,150431,150783,162138,146526,25584,71346,83422,84233,72040,87871,71013,152875,152475,154702,154703,152477,157861,161331,161312,160919,160917,163617,163993,177871,175311,150779,150899,145764,102353,81427,87722,67684,21228,102160,109046,174980,108179,145697,135122,150762,150995,145626,69037,55914,86527,60105,77363,126141,143729,55992,142786,55996,159824,168105,89042,167867,123361,131604,146117,126304,127227,101173,83812,74945,129245,82413,116303,152673,174934,159938,159833,161457,143988,110270,164161,158858,158621,158767,143449,169298,160277,160280,161821,171451,175441,177721,178514,179105,179174,179692,68276,175364,70899,141259,141446,144834,144406,141955,152441,152650,152647,152648,153030,152712,154725,156207,157691,42854,84751,20836,82240,79029,78700,102149,59443,103377,107243,109574,109459,117667,175801,175852,153027,117217,142661,119570,116082,88155,113159,132904,101093,163672,163673,163674,163671,165183,168941,102807,175334,134567,117650,161498,136005,116622,103444,68019,127366,129967,128643,136604,107185,154501,154529,154522,155447,161293,160912,161841,162387,171198,169365,174280,166917,151177,152826,160898,142147,136475,77873,100347,112037,102993,114525,118352,125822,128518,128561,73406,89332,100598,152394,155004,159602,160862,163996,166589,171537,126737,141284,172968,101673,160832,165458,164608,165098,164597,170162,101382,109965,109313,157979,126723,154960,129164,75180,144646,142622,152538,151173,152512,152499,152500,154593,155175,160786,119858,124529,124455,129846,131651,83181,132025,134495,60598,151126,157953,157952,68318,71298,102277,101467,108681,108572,111362,110243,74617,107358,114202,117283,158675,137115,158934,154896,158929,164584,171819,130226,173504,174570,115250,172899,108986,111455,111763,109423,110225,110357,110376,112373,112687,117862,91283,119440,118584,117537,172614,117170,168503,134831,171958,108913,176453,156193,85250,176672,136236,154661,156303,162191,167730,169831,91466,167668,56643,100562,82695,150914,123240,124948,124208,152469,159776,161283,163355,167866,166731,169504,172349,125182,173877,163596,141870,161107,102223,146051,145062,154829,150222,101854,75292,64941,115562,103365,117804,123204,124854,127238,126657,132796,140668,143339,140659,143342,162649,165986,165723,166729,167084,168424,168737,169411,168845,171609,174942,172184,180787,135181,150747,145779,126409,56173,77377,67982,56171,74332,68044,67983,160546,161166,163577,165457,174833,169235,171873,170626,126246,126285,126397,155828,164871,166740,166221,175280,145463,130048,131639,110007,130047,134024,163634,60553,67474,46738,105781,56700,109655,109664,109045,111654,109941,110241,110064,109794,175767,158048,119868,110353,128649,174333,171796,29683,76719,146514,132746,140913,100484,62127,76991,21941,81746,55133,79018,78652,84733,23149,30345,100727,124359,126775,127813,127766,126110,131730,130039,130475,131729,134295,133342,133462,127521,
            115568,165474,167911,159569,150262,143513,143500,116237,127073,135163,135167,102400,112841,112590,114194,115525,115527,116637,81564,118234,115526,134790,111289,74437,68108,152431,157880,160413,161492,174657,130279,169401,114754,173386,162964,103731,60112,77613,101326,107705,111181,111479,110505,110374,113957,116620,82358,107833,107085,106990,114369,114752,132106,114753,154477,158733,158771,158738,91840,40789,69612,70926,23128,20528,84914,105049,105116,108484,109165,109217,55521,79301,55511,100560,104171,62254,55528,110208,110229,110228,110840,110021,85173,65621,100966,108457,108716,108626,108937,109420,108998,111409,112046,111422,104966,135566,146454,150281,88944,60986,74896,77501,88735,56748,104313,26997,127829,150844,21126,101601,62335,61938,76762,150221,29978,104519,131368,136269,154682,162491,165875,164394,166747,167782,170697,134312,119483,111021,126241,108966,111611,111408,111528,109426,110804,113269,114068,117711,119903,123908,124727,128696,100407,75915,75496,84906,74517,70889,104577,67567,75919,104537,87729,173819,118497,85811,118176,119471,119499,123711,117049,125497,125073,125920,126047,124193,114003,89190,104103,101662,85962,124678,101241,127395,127419,45589,132242,133927,71976,71120,67306,102025,103510,85432,46896,73017,67999,100681,106225,101461,106653,125575,124515,129423,100498,135211,141415,143145,130714,145840,142723,142248,154769,165173,108444,79931,158252,153057,154668,151106,110061,109727,123906,110214,80396,76497,68189,82728,85010,62394,60766,74424,81323,21381,46892,82351,116197,116532,116535,116227,106939,119726,91621,103387,107146,125174,21379,127427,166185,174690,166293,167811,169279,169256,168401,168626,171449,105217,110634,131542,126337,124795,125693,154675,161385,145328,127092,111844,127191,135505,108655,56900,174830,80929,100816,175918,179302,89390,120009,177801,116765,126949,130041,107049,124338,124652,124787,126980,129758,134591,140945,80848,118494,152717,155317,131969,134595,159238,143087,128581,137132,173678,103942,152873,106540,129202,78710
      ]

        Actor.log.info(f"Will scrape {len(antenna_ids)} specific antenna IDs")

        async with aiohttp.ClientSession() as session:
            all_detailed_results = []

            for i, antenna_id in enumerate(antenna_ids):
                Actor.log.info(f"Processing antenna {i+1}/{len(antenna_ids)}: ID {antenna_id}")

                # Get detailed information
                detailed_data = await scraper.get_antenna_details(session, str(antenna_id))

                all_detailed_results.append(detailed_data)

                # Small delay to be respectful to the server
                await asyncio.sleep(1)

                # Push data in batches of 50 to avoid memory issues
                if len(all_detailed_results) % 50 == 0:
                    Actor.log.info(f"Pushing batch of results to dataset (processed {len(all_detailed_results)} so far)")
                    await Actor.push_data(all_detailed_results[-50:])

            # Push any remaining results
            if len(all_detailed_results) % 50 != 0:
                remaining_count = len(all_detailed_results) % 50
                Actor.log.info(f"Pushing final batch of {remaining_count} results to dataset")
                await Actor.push_data(all_detailed_results[-remaining_count:])

            Actor.log.info(f"=== SCRAPING COMPLETE: Successfully processed {len(all_detailed_results)} antennas ===")

if __name__ == "__main__":
    asyncio.run(main_Scrape_specific_missing_AntennaIDS())
